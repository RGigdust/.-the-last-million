<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>The Last Million | Grand Empire</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
    <style>
        body { margin: 0; background: #050a05; overflow: hidden; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© */
        .hud { position: fixed; top: 10px; left: 10px; right: 10px; display: flex; justify-content: space-between; z-index: 100; pointer-events: none; }
        .stat-box { background: rgba(0, 0, 0, 0.7); border: 1px solid gold; color: gold; padding: 5px 15px; border-radius: 10px; box-shadow: 0 0 10px rgba(255, 215, 0, 0.3); pointer-events: auto; }
        .gopass-btn { position: fixed; bottom: 20px; right: 20px; background: linear-gradient(45deg, #ff00cc, #3333ff); color: white; padding: 10px 20px; border-radius: 25px; cursor: pointer; border: none; font-weight: bold; z-index: 100; box-shadow: 0 0 15px #ff00cc; }
        .shop-panel { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80%; height: 60%; background: rgba(10, 20, 10, 0.95); border: 3px solid gold; border-radius: 20px; display: none; z-index: 2000; padding: 20px; color: white; overflow-y: auto; }
        .close-btn { color: red; float: left; cursor: pointer; font-weight: bold; }
        .item-card { border: 1px solid #444; padding: 10px; margin: 10px 0; display: flex; justify-content: space-between; align-items: center; border-radius: 10px; background: rgba(255,255,255,0.05); }
    </style>
</head>
<body>

    <div class="hud">
        <div class="stat-box">ğŸ’° Ø§Ù„Ø±ØµÙŠØ¯: <span id="balance">0.00</span> $LAST</div>
        <div class="stat-box">ğŸ° Ø§Ù„Ø¬ÙŠØ´: <span id="army-size">1</span> Ù…Ø­Ø§Ø±Ø¨</div>
    </div>

    <button class="gopass-btn" onclick="toggleShop()">ğŸ›’ Ø§Ù„Ù…ØªØ¬Ø± Ùˆ GoPass</button>

    <div id="shop" class="shop-panel">
        <span class="close-btn" onclick="toggleShop()">âœ– Ø¥ØºÙ„Ø§Ù‚</span>
        <h2>ğŸ›ï¸ Ù…ØªØ¬Ø± Ø§Ù„Ø¹Ø±ÙŠÙ† Ùˆ GoPass</h2>
        <div class="item-card">
            <span>ğŸ›¡ï¸ Ø¯Ø±Ø¹ Ø°Ù‡Ø¨ÙŠ (NFT) - Ø­Ù…Ø§ÙŠØ© +50</span>
            <button onclick="buyItem(100)">Ø´Ø±Ø§Ø¡ (100 $LAST)</button>
        </div>
        <div class="item-card" style="background: linear-gradient(90deg, #4b0082, #000);">
            <span>ğŸ’ Ù…Ù…Ø± Ø§Ù„Ù…Ù„ÙˆÙƒ (GoPass) - Ø¬ÙˆØ§ÙŠØ² Ù…Ø¶Ø§Ø¹ÙØ©</span>
            <button onclick="buyItem(500)">ØªÙØ¹ÙŠÙ„ (500 $LAST)</button>
        </div>
    </div>

    <div id="game-container"></div>

    <script>
        let balance = 150.00; 
        const config = {
            type: Phaser.AUTO, width: window.innerWidth, height: window.innerHeight,
            parent: 'game-container',
            physics: { default: 'arcade' },
            scene: { preload: preload, create: create, update: update }
        };

        const game = new Phaser.Game(config);
        let player, target, light, trees;

        function preload() {
            this.load.image('lion', 'https://cdn-icons-png.flaticon.com/512/616/616412.png'); // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù…Ø¤Ù‚ØªØ© Ù„Ù„Ø£Ø³Ø¯
            this.load.image('tree', 'https://cdn-icons-png.flaticon.com/512/490/490391.png');
        }

        function create() {
            this.physics.world.setBounds(0, 0, 4000, 4000);
            this.lights.enable().setAmbientColor(0x333333);

            // ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØºØ§Ø¨Ø©
            for (let i = 0; i < 60; i++) {
                let x = Phaser.Math.Between(0, 4000);
                let y = Phaser.Math.Between(0, 4000);
                let tree = this.add.image(x, y, 'tree').setScale(0.4).setOrigin(0.5, 1).setPipeline('Light2D');
                tree.setDepth(y);
            }

            // Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¨ÙˆØ±ØµØ© (Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©)
            this.add.circle(2000, 2000, 300, 0xffd700, 0.2).setPipeline('Light2D');
            this.add.text(2000, 1800, "ğŸ›ï¸ Ù…Ø±ÙƒØ² Ø§Ù„ØªØ¯Ø§ÙˆÙ„ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ", { color: '#ffd700', fontSize: '24px' }).setOrigin(0.5);

            // Ø§Ù„Ù„Ø§Ø¹Ø¨
            player = this.physics.add.sprite(2000, 2200, 'lion').setScale(0.2).setPipeline('Light2D');
            player.setDepth(2200);

            // Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ø£Ø³Ø¯ (ÙƒØ´Ø§Ù Ø§Ù„Ø§Ø³ØªÙƒØ´Ø§Ù)
            light = this.lights.addLight(0, 0, 500).setIntensity(2).setColor(0xffffff);

            this.cameras.main.startFollow(player, true, 0.08, 0.08);
            this.cameras.main.setZoom(1);

            this.input.on('pointerdown', (pointer) => {
                target = pointer.positionToCamera(this.cameras.main);
                this.physics.moveToObject(player, target, 250);
            });
        }

        function update() {
            light.x = player.x;
            light.y = player.y;
            player.setDepth(player.y);

            if (target) {
                let dist = Phaser.Math.Distance.Between(player.x, player.y, target.x, target.y);
                if (dist < 10) { player.body.reset(target.x, target.y); target = null; }
                player.setFlipX(player.body.velocity.x < 0);
            }
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØªØ¬Ø±
        function toggleShop() {
            const shop = document.getElementById('shop');
            shop.style.display = (shop.style.display === 'block') ? 'none' : 'block';
        }

        function buyItem(price) {
            if (balance >= price) {
                balance -= price;
                document.getElementById('balance').innerText = balance.toFixed(2);
                alert("ØªÙ…Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­! Ø²Ø§Ø¯Øª Ù‡ÙŠØ¨Ø© Ù…Ù„ÙƒÙƒ. ğŸ¦âœ¨");
            } else {
                alert("Ø±ØµÙŠØ¯Ùƒ ØºÙŠØ± ÙƒØ§ÙÙ.. Ø§Ø°Ù‡Ø¨ Ù„Ù„ØªØ¹Ø¯ÙŠÙ† Ø£Ùˆ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±!");
            }
        }
    </script>
</body>
</html>
