<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>The Last Million | Evolution</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
    <style>
        body { margin: 0; background: #020502; overflow: hidden; font-family: 'Cairo', sans-serif; }
        .ui-top { position: fixed; top: 20px; width: 100%; display: flex; justify-content: center; gap: 10px; z-index: 1000; pointer-events: none; }
        .stat-box { background: rgba(0,0,0,0.8); padding: 8px 20px; border-radius: 20px; border: 1px solid gold; color: gold; font-weight: bold; }
        .rank-tag { color: #fff; font-size: 0.8rem; display: block; text-align: center; }
    </style>
</head>
<body>

    <div class="ui-top">
        <div class="stat-box">
            <span class="rank-tag" id="rank-name">الرتبة: شبل</span>
            السيادة: <span id="balance">0.000</span> $LAST
        </div>
    </div>

    <div id="game-container"></div>

    <script>
        const config = {
            type: Phaser.AUTO,
            width: window.innerWidth, height: window.innerHeight,
            parent: 'game-container', transparent: true,
            physics: { default: 'arcade' },
            scene: { preload: preload, create: create, update: update }
        };

        const game = new Phaser.Game(config);
        let player, target, score = 0, otherCubs = [];

        function preload() {
            this.load.image('lion', 'wingedlionpng.png');
            this.load.image('tree', 'https://cdn-icons-png.flaticon.com/512/490/490391.png');
        }

        function create() {
            this.physics.world.setBounds(0, 0, 4000, 4000);

            // إضافة الأشجار
            for (let i = 0; i < 50; i++) {
                this.add.image(Phaser.Math.Between(0, 4000), Phaser.Math.Between(0, 4000), 'tree').setScale(0.2).setAlpha(0.3);
            }

            // إنشاء اللاعب (البداية كـ "شبل" صغير)
            player = this.physics.add.sprite(2000, 2000, 'lion').setScale(0.2); // مقاس صغير في البداية
            player.setDepth(100);

            // إضافة "أشبال" أخرى بتتحرك عشوائياً (محاكاة للاعبين)
            for (let i = 0; i < 5; i++) {
                let cub = this.physics.add.sprite(Phaser.Math.Between(1800, 2200), Phaser.Math.Between(1800, 2200), 'lion');
                cub.setScale(0.15).setAlpha(0.5).setTint(0xaaaaaa);
                cub.nameTag = this.add.text(cub.x, cub.y - 30, "لاعب " + Phaser.Math.Between(100, 999), { fontSize: '12px', fill: '#fff' }).setOrigin(0.5);
                otherCubs.push(cub);
            }

            this.cameras.main.startFollow(player, true, 0.08, 0.08);

            this.input.on('pointerdown', (pointer) => {
                target = pointer.positionToCamera(this.cameras.main);
                this.physics.moveToObject(player, target, 250);
            });
        }

        function update() {
            if (target) {
                let dist = Phaser.Math.Distance.Between(player.x, player.y, target.x, target.y);
                if (dist < 10) { player.body.reset(target.x, target.y); target = null; }
                player.setFlipX(player.body.velocity.x < 0);
                
                // زيادة الرصيد والنمو
                score += 0.001;
                document.getElementById('balance').innerText = score.toFixed(3);
                
                // نظام النمو: كل ما زاد السكور، حجم الأسد بيكبر
                if (score > 1 && player.scale < 0.4) {
                    player.setScale(player.scale + 0.0001);
                    updateRank(score);
                }
            }

            // تحريك الأشبال الأخرى بشكل عشوائي "لايف"
            otherCubs.forEach(cub => {
                if (Phaser.Math.Between(0, 100) > 98) {
                    this.physics.moveTo(cub, Phaser.Math.Between(0, 4000), Phaser.Math.Between(0, 4000), 100);
                }
                cub.nameTag.x = cub.x;
                cub.nameTag.y = cub.y - 30;
                cub.setFlipX(cub.body.velocity.x < 0);
            });
        }

        function updateRank(s) {
            let rankElement = document.getElementById('rank-name');
            if (s > 10) rankElement.innerText = "الرتبة: أسد ملك";
            else if (s > 5) rankElement.innerText = "الرتبة: سبع";
            else rankElement.innerText = "الرتبة: شبل";
        }
    </script>
</body>
</html>
